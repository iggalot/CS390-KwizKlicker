<script language="javascript">
    window.status = 'waiting';
    var room_id = <%= @room.id %>;
    var is_active = <%= @room.state.nil? ? 0 : 1 %>;
    var current_question = <%= @room.active_question.nil? ? -1 : @room.active_question %>;

    var job = setInterval(function() {
        $.get('/api/active/' + room_id, function(data) {

            //console.log(room_id, is_active, current_question, JSON.stringify(data));

            if(!!data.active != is_active)
        {
            window.status = 'continue';
           // console.log('reloading!');
            clearInterval(job);
            window.location.reload();
            return;
        }

        var test = false;
        if (data.question != current_question) {
            window.status = 'continue';
            //console.log('going to question', test);
            test = true;
            clearInterval(job);

            if(!presenting)
              window.location.href = '/rooms/quiz/' + room_id + '/question/' + data.question;
            else
              window.location.reload();
        }

    });
    }, 200);
</script>